alias cleands='find . -name ".DS_Store" -exec rm {} \;'
alias jn='jupyter notebook'
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'
alias c='clear'
alias brewall='brew update && brew upgrade && brew doctor && brew cleanup && brew autoremove'
alias brewdtree='brew deps --tree --installed'
alias lg=lazygit
alias ld=lazydocker
alias t='tmux'
alias tks='tmux kill-session'

update () {
    plugin-update
    brewall
    nvim -c "PackerSync"
}

if command -v nvim &> /dev/null
then
    alias vim=nvim
fi

if command -v bat &> /dev/null
then
    alias cat=bat
fi

if command -v exa &> /dev/null
then
    alias l='exa'
    alias ls='exa'
    alias ll='exa -ll'
    alias la='exa -la'
fi


if [[ $TERM == "xterm-kitty" ]]; then
    alias ssh="kitty +kitten ssh"
fi

# function to mkdir and cd into it
function mkcd() {
    mkdir -p $1
    cd $1
}

# fzf stuff
function fe() {
    IFS=$'\n' files=($(fzf --height 70% --preview='bat --color=always --style=numbers {}' --bind shift-up:preview-page-up,shift-down:preview-page-down))
    [[ -n "$files" ]] && ${EDITOR} -O "${files[@]}" -p
}

# alias notes='cd ~/Documents/Dropbox/Notes/ && fe'

# clone a plugin, identify its init file, source it, and add it to your fpath
function plugin-load {
local repo plugin_name plugin_dir initfile initfiles
ZPLUGINDIR=${ZPLUGINDIR:-${ZDOTDIR:-$HOME/.config/zsh}/plugins}
for repo in $@; do
    plugin_name=${repo:t}
    plugin_dir=$ZPLUGINDIR/$plugin_name
    initfile=$plugin_dir/$plugin_name.plugin.zsh
    if [[ ! -d $plugin_dir ]]; then
        echo "Cloning $repo"
        git clone -q --depth 1 --recursive --shallow-submodules https://github.com/$repo $plugin_dir
    fi
    if [[ ! -e $initfile ]]; then
        initfiles=($plugin_dir/*.plugin.{z,}sh(N) $plugin_dir/*.{z,}sh{-theme,}(N))
        [[ ${#initfiles[@]} -gt 0 ]] || { echo >&2 "Plugin has no init file '$repo'." && continue }
        ln -sf "${initfiles[1]}" "$initfile"
    fi
    fpath+=$plugin_dir
    (( $+functions[zsh-defer] )) && zsh-defer . $initfile || . $initfile
done
}

function plugin-update {
ZPLUGINDIR=${ZPLUGINDIR:-$HOME/.config/zsh/plugins}
for d in $ZPLUGINDIR/*/.git(/); do
    echo "Updating ${d:h:t}..."
    command git -C "${d:h}" pull --ff --recurse-submodules --depth 1 --rebase --autostash
done
}
